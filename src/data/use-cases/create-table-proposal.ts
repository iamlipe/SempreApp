import { ipcMain } from "electron";
import { dbPath } from "../utils/db-path";

import Database from "better-sqlite3";

ipcMain.handle('create-table-proposal', async () => {
    try {
        const db = new Database(dbPath);


        const sql = `CREATE TABLE IF NOT EXISTS propostas (
            id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
            numero_da_proposta TEXT,
            referencia_do_cliente TEXT,
            empresa TEXT,
            cnpj TEXT,
            solicitante TEXT,
            email TEXT,
            telefone TEXT,
            faturamento TEXT,
            estado_de_faturamento TEXT,
            sistema TEXT,
            forma_de_pagamento TEXT,
            condicao_de_pagamento TEXT,
            prazo_de_entrega_e_cronograma TEXT,
            campo_item_1 TEXT,
            caracteristicas_do_primeiro_banco_de_baterias TEXT,
            campo_item_2 TEXT,
            caracteristicas_do_segundo_banco_de_baterias TEXT,
            tipo_de_equipamento TEXT,
            tensao_nominal TEXT,
            corrente_de_saida TEXT,
            tensao_nominal_entrada TEXT,
            frequencia_nominal TEXT,
            fator_de_potencia TEXT,
            tolerancia TEXT,
            rendimento TEXT,
            tipo_de_bateria TEXT,
            numero_de_elementos TEXT,
            capacidade TEXT,
            voltagem_de_flutuacao TEXT,
            voltagem_de_carga TEXT,
            voltagem_de_carga_profunda TEXT,
            tensao_maxima_consumidor TEXT,
            tensao_minima_consumidor TEXT,
            queda_na_uqd TEXT,
            numero_de_estagios TEXT,
            tipo_de_retificador TEXT,
            distorcao_harmonica TEXT,
            corrente_de_entrada_protecao_geral TEXT,
            tipo_de_disjuntor_protecao_geral TEXT,
            corrente_de_ruptura_protecao_geral TEXT,
            contato_auxiliar_protecao_geral TEXT,
            corrente_de_saida_bateria TEXT,
            tipo_de_disjuntor_bateria TEXT,
            corrente_de_ruptura_bateria TEXT,
            contato_auxiliar_bateria TEXT,
            corrente_de_saida_consumidor TEXT,
            tipo_de_disjunto_consumidor TEXT,
            corrente_de_ruptura_consumidor TEXT,
            contato_auxiliar_consumidor TEXT,
            quantidade_de_disjuntores_consumidor TEXT,
            fusivel_de_potencia TEXT,
            protecao_circuitos_auxiliares TEXT,
            fusivel_de_potencia_na_coluna_retificadora TEXT,
            tratamento_da_barra TEXT,
            tipo_de_fiacao TEXT,
            identificacao_de_cabos TEXT,
            material_do_gabinete TEXT,
            grau_de_protecao TEXT,
            tipo_de_pintura TEXT,
            cor_externa TEXT,
            soleira_na_base TEXT,
            entrada_e_saida_de_cabos TEXT,
            exaustao_de_ar_quente TEXT,
            protecao_nr10 TEXT,
            diodo_de_bloqueio TEXT,
            disconexao_de_bateria TEXT,
            alarme_sonoro TEXT,
            sinalizacao_visual_led TEXT,
            sinalizacao_remota_sete_reles TEXT,
            protecao_contra_surtos_adicional TEXT,
            plaqueta_de_identificacao TEXT,
            sensores_corrente_alternada TEXT,
            tipo_de_instrumento TEXT,
            instrumento_de_medicao_voltimetro_corrente_continua TEXT,
            instrumento_de_medicao_voltimetro_corrente_alternada TEXT,
            instrumento_de_medicao_amperimetro_corrente_continua TEXT,
            instrumento_de_medicao_amperimetro_corrente_alternada TEXT,
            transdutor_quatro_a_vinte_ma_tensao TEXT,
            transdutor_quatro_a_vinte_ma_corrente TEXT,
            chave_liga_desliga TEXT,
            chave_flutuacao_e_carga TEXT,
            chave_carga_profunda TEXT,
            chave_reposicao TEXT,
            software_ccs_tools TEXT,
            comunicacao_supervisorio TEXT,
            sobressalentes TEXT,
            tomada_de_servicoes TEXT,
            sistema_de_calefacao TEXT,
            terminal_de_aterramento TEXT,
            porta_documentos TEXT,
            mao_de_obra_engenharia TEXT,
            mao_de_obra_mecanica TEXT,
            mao_de_obra_eletrica TEXT,
            mao_de_obra_operacional TEXT,
            mao_de_obra_administracao TEXT,
            idioma_da_documentacao TEXT,
            tipo_de_documentacao TEXT,
            ensaios_e_testes TEXT,
            start_up TEXT,
            start_up_estado TEXT,
            start_up_valor TEXT,
            frete TEXT,
            frete_estado TEXT,
            frete_valor TEXT,
            comissao_margem_de_venda TEXT,
            comissao_vendedor TEXT,
            treinamento TEXT,
            treinamento_estado TEXT,
            treinamento_valor TEXT,
            outros_opcionais TEXT,
            outros_opcionais_valor TEXT,
            valor_bateria_1 TEXT,
            valor_sem_impostos TEXT,
            irpj TEXT,
            cofins TEXT,
            pis TEXT,
            csll TEXT,
            icms TEXT,
            ipi TEXT,
            valor_com_pis_cofins TEXT,
            valor_com_icms TEXT,
            valor_unitario_com_todos_os_impostos TEXT,
            criado_em TEXT,
            atualizado_em TEXT
        );`
        db.prepare(sql).run();
        db.close();
        console.log('Tabela de propostas criada com sucesso.');
        return { message: 'Tabela criada com sucesso.' };
    } catch (error) {
        console.error('Erro ao criar a tabela de propostas:', error.message);
        throw error;
    }
});